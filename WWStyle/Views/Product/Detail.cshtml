@model Product
@{

}

<h2>Product Detail</h2>
<hr />
<div class="row gx-4 gx-lg-5 align-items-center" style="margin-bottom: 10px">
                    <div class="col-md-6"><img class="card-img-top mb-5 mb-md-0" src="@Model.Picture" alt="..."></div>
                    <div class="col-md-6">
                        <div class="small mb-1">Id: @Model.ProductId</div>
                        <h1 class="display-5 fw-bolder">@Model.ProductName</h1>
                        <div class="fs-5 mb-5">
                     @*        <span class="text-decoration-line-through">@Model.Price</span> *@
                            <span>$@Model.Price</span>
                        </div>
                        <p class="lead">@Model.Description</p>
                          <p class="lead">In stock: @Model.Stock</p>

                    <form method="post" asp-controller="ShoppingCart" asp-action="AddToCart">
                        <div class="d-flex">
                            <input name="productId" type="hidden" value="@Model.ProductId">
                            <input name="quantity" class="form-control text-center me-3" id="inputQuantity" type="number" value="1" style="max-width: 3rem">

                            <button class="btn btn-outline-dark flex-shrink-0" type="submit">
                                <i class="bi-cart-fill me-1"></i>
                                Add to cart
                            </button>
                            
                        </div>
                    </form>
                    </div>
                </div>
<button class="btn btn-outline-dark flex-shrink-0 hBack" type="button" style="margin-bottom: 100px">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-left-short" viewBox="0 0 16 16">
        <path fill-rule="evenodd" d="M12 8a.5.5 0 0 1-.5.5H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11.5a.5.5 0 0 1 .5.5" />
    </svg>
    Back
</button>


@if (Model.Comments != null && Model.Comments.Any())
{
    <h3>Comments</h3>
    <div id="comments">
        @{
            await Html.RenderPartialAsync("_Comments", Model.Comments);
        }
    </div>
}
else
{
    <p>No comments yet.</p>
}

<!-- Formulär för att lägga till en ny kommentar -->
<h3>Add a comment</h3>
<form style="margin-bottom: 100px" id="commentForm" method="post" action="/Product/AddComment">
    @Html.AntiForgeryToken()
    <input type="hidden" name="productId" value="@Model.ProductId" />
    <div class="form-group">
        <label for="userName">Name:</label>
        <input type="text" id="userName" name="userName" class="form-control" required />
    </div>
    <div class="form-group">
        <label for="commentText">Comment:</label>
        <textarea id="commentText" name="commentText" class="form-control" rows="3" required></textarea>
    </div>
    <button type="submit" class="btn btn-outline-dark flex-shrink-0">
        <i class="bi bi-send-check"></i>
        Submit
    </button>
</form>

<!-- Skript för att ladda om sidan efter att en ny kommentar har lagts till -->
<script>
    // Lyssna på formulärinskickning
    $('#commentForm').submit(function (event) {
        event.preventDefault(); // Förhindra standardformulärinskickning

        // Skicka formulärdata med AJAX
        $.ajax({
            url: $(this).attr('action'),
            type: 'POST',
            data: $(this).serialize(),
            success: function (response) {
                // Ladda om sidan efter att kommentaren har lagts till
                location.reload();
            },
            error: function (xhr, status, error) {
                console.error(xhr.responseText);
            }
        });
    });
</script>

